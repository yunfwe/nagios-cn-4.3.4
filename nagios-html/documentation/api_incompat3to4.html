<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nagios: API incompatibilities between Nagios 3 and 4</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="api_incompat3to4">API incompatibilities between Nagios 3 and 4 </a></h1><p>A list of API incompatibilities between Nagios 3 and 4.</p>
<p>[TOC]</p>
<h2><a class="anchor" id="globalvars">
Global Variables</a></h2>
<ul>
<li>event_list_{high,low} and event_list_{high,low}_tail are no more. Instead there is "squeue_t *nagios_squeue", which is a single queue to handle all timed events. </li>
<li>last_command_check, command_check_interval, external_command_buffer and external_command_buffer_slots are no more. </li>
<li>check_result_list is no more </li>
<li>passive_check_result_list and passive_check_result_list_tail are no more.</li>
</ul>
<h2><a class="anchor" id="datastructures">
Data Structures</a></h2>
<ul>
<li>All primary objects have been given an 'id' field, which can be used to store additional data about each object, or mark them in bitmaps, or... </li>
<li>Container-ish pointers have been removed pretty much everywhere in favour of testable libraries with specific lookup properties and containers. This means 'next_hash' etc no longer exist in any object. The 'next' pointers in primary objects still remain, but you should avoid using them in favour of iterating over objects using the object arrays. </li>
<li>next and prev have been removed from timed_event. It's no longer possible to sanely loop over all queued elements, since the squeue library keeps its types opaque. Adding an "squeue_foreach()" thing would be as simple as running a breadth-first search in the pqueue library that drives the squeue implementation. </li>
<li>The scheduled_downtime data type now has start_event and stop_event. </li>
<li>nebstruct_program_status_data no longer has a last_command_check var. </li>
<li>The passive_service_check data type is no more. </li>
<li>The data type circular_buffer has been removed. </li>
<li>The host object's notify_on_down, notify_on_up, notify_on_blablah variables have been replaced with a single "notification_options" field instead, which is a small hand-managed bitmask of the states we should notify on, based on 1 &lt;&lt; current_state. </li>
<li>As per above, with flap_detection_options </li>
<li>As per above, with stalking_options </li>
<li>As per the three above, with services </li>
<li>As per above, with dependencies which now have a "failure_options" field instead of multiple "fail_on_foo" fields. </li>
<li>As per above with escalations, which now have an "escalation_options" field instead of multiple "escalate on foo" fields.</li>
</ul>
<h2><a class="anchor" id="functions">
Functions</a></h2>
<ul>
<li>Event queue management functions have been significantly altered to match the new scheduling queue implementation. add_event(), remove_event(), reschedule_event() and schedule_new_event() are the primary ones. </li>
<li>submit_external_command() and submit_raw_external_command() have been removed, as has check_for_external_commands(). </li>
<li>All functions handling adding and removing objects to circular buffers or other types of linked lists used for searching have been removed. </li>
<li>The *host*_3x() functions are gone. They have been replaced with versions without the _3x suffix. </li>
<li>run_sync_host_check_3x() is gone. perform_on_demand_host_check(), which previously only called run_sync_host_check_3x(), now does something sensible instead of calling out to a single helper. </li>
<li>Using the 'struct host_struct *foo' form of type-naming has been obsoleted and will no longer work. Use 'struct host' instead. </li>
<li>Use of typedef'ed typenames for non-opaque structures is now deprecated. The typedef's will be removed in Nagios 5, and modules that wish to continue using them after that will have to add them themselves. The new preferred form is 'struct host *foo', which clearly shows that we're dealing with a non-opaque type. </li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 9 Sep 2017 for Nagios by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
